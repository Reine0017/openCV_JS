<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>OpenCV javascript test</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!--link rel="stylesheet" type="text/css" media="screen" href="main.css"-->
		<script async src="js/opencv.js" onload="onOpenCvReady();" type="text/javascript"></script>
	</head>

	<body>
		<div>
			<img id="input_image">
			<input type="file" id="file_input">
			<canvas id='output'></canvas>
		</div>
	</body>

	<script>
		let img_input = document.getElementById('input_image');
		let file_input = document.getElementById('file_input');

		file_input.addEventListener('change', (e) => {
			img_input.src = URL.createObjectURL(e.target.files[0])
		},false);

		img_input.onload = function(){
			let mat = cv.imread(img_input);
			cv.cvtColor(mat,mat,cv.COLOR_RGB2GRAY);
			cv.imshow('output', mat);
			mat.delete();
		};

		function onOpenCvReady() {
  			document.getElementById('status').innerHTML = 'OpenCV.js is ready.';
		}
	</script>
</html>